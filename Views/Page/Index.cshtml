@model dynamic
@{
    ViewData["Title"] = Model.Title;
    Layout = "~/Views/Shared/_Layout.cshtml";
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" />

}

<style>
    .nav-tabs {
        border-bottom: none !important;
    }

        .nav-tabs .nav-link {
            border: none !important;
            border-radius: 0 !important;
            background-color: transparent !important;
            color: #333;
        }

            .nav-tabs .nav-link.active {
                font-weight: bold;
                color: #007b5e !important;
                border-bottom: 3px solid #f0a500 !important; /* ✅ thanh vàng dưới */
            }

</style>

<div class="container mt-5">
    <h2 class="text-primary mb-4">@Model.Title</h2>
    <div class="row mb-5">
        <div class="col-md-6">
            <img src="@Model.Img" class="img-fluid rounded shadow" alt="@Model.Title" />
        </div>
        <div class="col-md-6">
            <p class="fs-5">@Model.MoTa</p>
            <p><strong>Lãi suất:</strong> <span class="text-success">Chỉ từ 1.0%/tháng</span></p>
            <p><strong>Thời hạn vay:</strong> Đến 30 năm</p>
            <p><strong>Hạn mức:</strong> Đến 500 triệu</p>
        </div>
    </div>

    <ul class="nav nav-tabs mb-4 justify-content-center" id="tabSection">
        <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#loiich">Lợi ích</a></li>
        <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#lienhe">Liên hệ</a></li>
        <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#hoso">Hồ sơ đăng ký</a></li>
    </ul>

    <div class="tab-content mb-5">
        <!-- Benefits Tab -->
        <div id="loiich" class="tab-pane fade show active">
            <div class="card shadow-sm border-0 p-4">
                <h3 class="mb-4 text-primary">Lợi ích</h3>
                <ul class="list-unstyled">
                    <li class="mb-3 d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i> Lãi suất cạnh tranh theo từng gói
                    </li>
                    <li class="mb-3 d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i> Thời hạn vay lên đến 30 năm
                    </li>
                    <li class="mb-3 d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i> Vay đến 100% giá trị tài sản
                    </li>
                    <li class="mb-3 d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i> Trả góp linh hoạt: tháng/quý/năm
                    </li>
                    <li class="mb-3 d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i> Ưu đãi thêm khi đăng ký qua app
                    </li>
                </ul>
            </div>
        </div>

        <!-- Contact Tab -->
        <div id="lienhe" class="tab-pane fade">
            <div class="card shadow-sm border-0 p-4">
                <h3 class="mb-4 text-primary">Liên hệ</h3>
                <ul class="list-unstyled">
                    <li class="mb-3 d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i> Liên hệ qua hotline, app, chi nhánh
                    </li>
                    <li class="mb-3 d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i> Dùng app BIDV Home để đăng ký
                    </li>
                    <li class="mb-3 d-flex align-items-start">
                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                        <div>
                            Thời gian xử lý:
                            <ul class="mt-2">
                                <li>Không thẩm định: 3 ngày</li>
                                <li>Thẩm định: 5 ngày</li>
                            </ul>
                        </div>
                    </li>
                    <li class="text-muted fst-italic">Thời gian không tính ngày nghỉ/lễ</li>
                </ul>
            </div>
        </div>

        <!-- Documents Tab -->
        <div id="hoso" class="tab-pane fade">
            <div class="card shadow-sm border-0 p-4">
                <h3 class="mb-4 text-primary">Hồ sơ cần chuẩn bị</h3>
                <ul class="list-unstyled">
                    <li class="mb-3 d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i> Giấy đề nghị vay vốn (theo mẫu của BIDV)
                    </li>
                    <li class="mb-3 d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i> CMND/CCCD/Hộ chiếu và Hộ khẩu thường trú/tạm trú
                    </li>
                    <li class="mb-3 d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i> Tài liệu chứng minh nguồn trả nợ
                    </li>
                    <li class="mb-3 d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i> Tài liệu liên quan về nhà/đất ở mua/xây dựng/sửa chữa
                    </li>
                    <li class="mb-3 d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i> Tài liệu liên quan về tài sản bảo đảm
                    </li>
                    <li class="mb-3 d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                        <a href="#" class="text-decoration-none text-primary">Tải mẫu biểu</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>


    <div class="d-flex justify-content-center mb-5">
        <a asp-controller="KhachHang" asp-action="CreateStep1" class="btn btn-success px-5 py-3 fs-5">
            Đăng ký vay ngay
        </a>
    </div>

    <div class="bg-light p-5 rounded shadow mb-5">
        <h4 class="text-center mb-4">Công cụ ước tính khoản vay</h4>
        <div class="row g-4">
            <div class="col-md-6">
                <label>Thu nhập hàng tháng của tôi là:</label>
                <input type="range" class="form-range" min="1000000" max="500000000" value="10000000" id="incomeRange">
                <div><span id="incomeDisplay">10,000,000</span> VND/tháng</div>

                <label class="mt-3">Chi tiêu hàng tháng của tôi là:</label>
                <input type="range" class="form-range" min="1000000" max="500000000" value="5000000" id="expenseRange">
                <div><span id="expenseDisplay">5,000,000</span> VND/tháng</div>

                <label class="mt-3">Kỳ hạn vay (tháng):</label>
                <input type="number" class="form-control" id="loanTerm" value="12">

                <label class="mt-3">Lãi suất (%/năm):</label>
                <input type="number" class="form-control" id="interestRate" value="8">
            </div>

            <div class="col-md-6 d-flex flex-column justify-content-center align-items-center">
                <p class="fs-5">Tổng số tiền bạn có thể vay là:</p>
                <h3 class="text-success" id="loanEstimate">0 VND</h3>
            </div>
        </div>
    </div>
</div>

<style>
    .nav-tabs .nav-link.active {
        font-weight: bold;
        border-bottom: 3px solid #f0a500;
        color: #007b5e;
    }
</style>

<script>
    const incomeRange = document.getElementById('incomeRange');
    const expenseRange = document.getElementById('expenseRange');
    const incomeDisplay = document.getElementById('incomeDisplay');
    const expenseDisplay = document.getElementById('expenseDisplay');
    const loanEstimate = document.getElementById('loanEstimate');

    function formatVND(number) {
        return number.toLocaleString('vi-VN') + ' VND';
    }

    function updateEstimate() {
        const income = parseInt(incomeRange.value);
        const expense = parseInt(expenseRange.value);
        const term = parseInt(document.getElementById('loanTerm').value);
        const interestYear = parseFloat(document.getElementById('interestRate').value);
        const interest = interestYear / 100 / 12;

        const savings = income - expense;

        if (savings > 0 && term > 0) {
            let pv = 0;
            if (interest > 0.0001) {
                pv = savings * ((1 - Math.pow(1 + interest, -term)) / interest);
            } else {
                pv = savings * term;
            }
            loanEstimate.innerText = formatVND(Math.round(pv));
        } else {
            loanEstimate.innerText = '0 VND';
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        incomeDisplay.innerText = formatVND(parseInt(incomeRange.value));
        expenseDisplay.innerText = formatVND(parseInt(expenseRange.value));
        updateEstimate();
    });

    incomeRange.addEventListener('input', () => {
        incomeDisplay.innerText = formatVND(parseInt(incomeRange.value));
        updateEstimate();
    });

    expenseRange.addEventListener('input', () => {
        expenseDisplay.innerText = formatVND(parseInt(expenseRange.value));
        updateEstimate();
    });

    document.getElementById('loanTerm').addEventListener('input', updateEstimate);
    document.getElementById('interestRate').addEventListener('input', updateEstimate);
</script>
